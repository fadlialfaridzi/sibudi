<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>

    <!-- Tailwind & Font Awesome -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- Navbar -->
    <%- include('../partials/navbarOutside') %>

    <!-- ======================
         KONTEN UTAMA
    ======================= -->
    <main
      class="flex flex-col md:flex-row gap-6 p-6 pt-24 flex-1 transition-all duration-300"
    >
      <!-- Panel Kiri: Daftar Buku -->
      <section class="md:w-1/3 bg-white rounded-2xl shadow-md p-4">
        <h2 class="text-lg font-semibold mb-3 text-green-700">
          Buku yang Sedang Dipinjam
        </h2>

        <ul id="loan-list">
          <% if (loans && loans.length > 0) { %>
            <% loans.forEach(function(loan, i) { %>
              <li
                class="loan-item mb-3 p-3 rounded-lg hover:bg-green-50 cursor-pointer transition border border-gray-200"
                data-index="<%= i %>"
              >
                <h3 class="font-medium text-gray-800"><%= loan.title %></h3>
                <p class="text-sm text-gray-500">
                  Penulis: <%= loan.author || '-' %>
                </p>
              </li>
            <% }); %>
          <% } else { %>
            <p class="text-gray-500 text-sm italic">
              Belum ada buku yang sedang dipinjam.
            </p>
          <% } %>
        </ul>
      </section>

      <!-- Panel Tengah: Detail Buku -->
      <section
        class="md:w-2/3 bg-white rounded-2xl shadow-md p-6"
        id="book-detail"
      >
        <h2 class="text-lg font-semibold mb-3 text-green-700">Detail Buku</h2>

        <div id="detail-content" class="text-gray-600">
          <p class="italic text-gray-500">
            Pilih buku dari daftar kiri untuk melihat detail dan melakukan
            perpanjangan.
          </p>
        </div>
      </section>

      <!-- Panel Kanan: Profil Member -->
      <aside
        class="md:w-1/4 bg-white rounded-2xl shadow-md p-4 text-center"
      >
        <% if (member) { %>
          <h3 class="text-green-700 font-semibold mb-2">Profil Anggota</h3>
          <p class="text-gray-700 font-medium"><%= member.member_name %></p>
          <p class="text-sm text-gray-500">ID: <%= member.member_id %></p>
          <p class="text-sm text-gray-500"><%= member.member_email %></p>

          <div class="mt-4 border-t pt-2 text-sm">
            <p class="text-gray-600">Total Denda Aktif:</p>
            <p class="font-semibold text-red-600">
              Rp <%= totalDenda ? totalDenda.toLocaleString('id-ID') : '0' %>
            </p>
          </div>
        <% } else { %>
          <p class="text-gray-500 text-sm italic">
            Data anggota tidak ditemukan.
          </p>
        <% } %>
      </aside>
    </main>

    <!-- ======================
         POPUP (INCLUDE)
    ======================= -->
    <%- include('../partials/popup', { popup: popup }) %>

    <!-- ======================
         DATA JSON UNTUK JS
    ======================= -->
    <script id="loans-data" type="application/json">
      <%- JSON.stringify(loans || []) %>
    </script>

    <!-- ======================
         SCRIPT EKSTERNAL
    ======================= -->
    <script src="/js/main.js"></script>
    <script src="/js/popup.js"></script>
  </body>
</html>
